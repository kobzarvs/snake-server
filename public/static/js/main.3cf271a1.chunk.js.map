{"version":3,"sources":["../node_modules/peerjs/dist sync","images/bg54.jpg","App.tsx","snake2.png","index.tsx"],"names":["webpackEmptyContext","req","e","Error","code","keys","resolve","module","exports","id","MAX_WIDTH","MAX_HEIGHT","SnakePoints","memo","points","x","y","draw","g","clear","lineStyle","RADIUS","moveTo","i","length","lineTo","beginFill","drawCircle","endFill","Snake","showPoints","simplifiedPoints","size","simplify","image","filters","PIXI","BlurFilter","FILTER_RESOLUTION","toString","Game","mouseEvent","scale","setMouseEvent","mouseDown","useState","speed","setSpeed","setLength","vector","setVector","mouse","setMouse","setShowPoints","push","createSnake","setPoints","slowDown","useCallback","handleKeyDown","key","len","shiftKey","console","log","value","handleKeyUp","useEffect","window","addEventListener","removeEventListener","mx","pageX","width","my","pageY","height","dx","dy","distance","Math","sqrt","vx","vy","animate","delta","prevLength","np","Array","last","j","undefined","requestAnimationFrame","useTick","background","tilePosition","tileScale","drawRect","App","innerWidth","innerHeight","setSize","setMouseDown","setScale","resize","handleMouseDown","buttons","handleWheel","ds","sign","deltaY","s","result","options","backgroundAlpha","backgroundColor","antialias","onPointerDown","onPointerUp","onPointerMove","url","URL","location","port","Number","searchParams","get","peer","Peer","host","config","iceServers","urls","credential","username","secure","peers","conn","bindConnection","on","open","send","err","error","destId","mc","socket","message","type","payload","connect","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.3cf271a1.chunk.js","sourcesContent":["function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = function() { return []; };\nwebpackEmptyContext.resolve = webpackEmptyContext;\nmodule.exports = webpackEmptyContext;\nwebpackEmptyContext.id = 35;","export default __webpack_public_path__ + \"static/media/bg54.2b57a65b.jpg\";","import React, {\n  memo,\n  useCallback,\n  useEffect,\n  // useRef,\n  useState,\n} from 'react';\nimport {\n  Container,\n  Graphics,\n  SimpleRope,\n  // Sprite,\n  Stage,\n  TilingSprite,\n  useTick,\n  // withFilters,\n} from '@inlet/react-pixi';\n// import {AdjustmentFilter} from '@pixi/filter-adjustment';\nimport * as PIXI from 'pixi.js';\n// import './App.css';\n// import {app} from './pixi/base/application';\n// import {init} from './pixi';\n// import bubbleImage from './bubble_32x32.png';\nimport snakeImage from './snake2.png';\n// import vertexShader from './vertex.glsl';\n// import fragmentShader from './fragment.glsl';\nimport background from './images/bg54.jpg';\nimport simplify from 'simplify-js';\n// import cosmosImage from './images/cosmos.jpg';\n\n\n// const shader = PIXI.Shader.from(vertexShader, fragmentShader, {\n//   iResolution: [window.innerWidth, window.innerHeight],\n//   iTime: 0,\n// });\n\nconst RADIUS = 8;\nconst MAX_WIDTH = 10000;\nconst MAX_HEIGHT = 10000;\nconst MIN_SCALE = 0.1;\nconst STEP_SCALE = 0.1;\nconst SIMPLIFY_TOLERANCE = 2;\nconst SIMPLIFY_QIALITY = true;\n\n// const Filters = withFilters(Container, {\n//   blur: PIXI.filters.BlurFilter,\n//   adjust: AdjustmentFilter,\n// });\n\n\n// @ts-ignore\nconst SnakePoints = memo(({points}) => {\n  return (\n    <Graphics\n      // filters={[new PIXI.filters.BlurFilter(5, 1, PIXI.settings.FILTER_RESOLUTION, 15)]}\n      x={0}\n      y={0}\n      draw={g => {\n        g.clear();\n        g.lineStyle(RADIUS*1.1, 0xff7979);\n\n        g.moveTo(points[0].x, points[0].y);\n        for (let i = 1; i < points.length; i++) {\n          g.lineTo(points[i].x, points[i].y);\n        }\n\n        g.lineStyle(1, 0xffffff);\n        // g.beginFill(0xff0022);\n        g.beginFill(0xff7979);\n        for (let i = 0; i < points.length; i++) {\n          g.drawCircle(points[i].x, points[i].y, RADIUS * .9);\n        }\n        g.endFill();\n      }} />\n  );\n});\n\n\n// @ts-ignore\nconst createSnake = ({x, y, length}) => {\n  const points = [];\n  for (let i = 0; i < length; i++) {\n    points.push(new PIXI.Point(x + i * RADIUS * 2, y));\n  }\n  return points;\n};\n\n// @ts-ignore\nconst Snake = memo(({points, showPoints = true, size}) => {\n  // shader.uniforms.iTime += 0.1;\n  // shader.uniforms.iResolution = [window.innerWidth, window.innerHeight];\n  const simplifiedPoints = simplify(points, SIMPLIFY_TOLERANCE, SIMPLIFY_QIALITY);\n  // console.log(points.length, simplifiedPoints.length,);\n\n  return (\n    <Container>\n      {/* @ts-ignore */}\n      {showPoints && <SnakePoints points={simplifiedPoints} />}\n      {!showPoints && <SimpleRope\n        key={[points.length, simplifiedPoints.length].toString()}\n        image={snakeImage}\n        // @ts-ignore\n        points={simplifiedPoints}\n        // points={points}\n        filters={[new PIXI.filters.BlurFilter(.25, 1, PIXI.settings.FILTER_RESOLUTION, 15)]}\n      />}\n    </Container>\n  );\n});\n\n\n// @ts-ignore\nexport const Game = memo(({mouseEvent, size, scale, setMouseEvent, mouseDown}) => {\n  const [speed, setSpeed] = useState(2);\n  const [length, setLength] = useState(25);\n  const [vector, setVector] = useState({x: -1, y: 1});\n  // const [pos, setPos] = useState({x: window.innerWidth / 2, y: window.innerHeight / 2});\n  const [mouse, setMouse] = useState({x: 0, y: 0});\n  const [showPoints, setShowPoints] = useState(true);\n  const [points, setPoints] = useState(createSnake({\n    x: 50, //window.innerWidth / 2,\n    y: 50, //window.innerHeight / 2,\n    length,\n  }));\n\n  const slowDown = useCallback(() => {\n    setSpeed(2);\n  }, [setSpeed]);\n\n  const handleKeyDown = useCallback((e: KeyboardEvent) => {\n    if (e.key === 'Escape') {\n      setShowPoints(value => !value);\n      return;\n    }\n    if (e.key === '+') {\n      setLength(len => len + 5);\n    } else if (e.key === '-') {\n      setLength(len => len > 10 ? len - 5 : 10);\n    }\n    if (e.shiftKey) {\n      console.log('shift down', e.shiftKey);\n      setSpeed(20);\n    }\n  }, [setSpeed, setLength, setShowPoints]);\n\n  const handleKeyUp = useCallback((e: KeyboardEvent) => {\n    if (!e.shiftKey && speed > 2) {\n      slowDown();\n    }\n  }, [slowDown, speed]);\n\n  useEffect(() => {\n    window.addEventListener('keydown', handleKeyDown);\n    window.addEventListener('keyup', handleKeyUp);\n    return () => {\n      window.removeEventListener('keydown', handleKeyDown);\n      window.removeEventListener('keyup', handleKeyUp);\n    };\n  }, [handleKeyDown, handleKeyUp]);\n\n  useEffect(() => {\n    if (!mouseEvent) {\n      return;\n    }\n    const e = mouseEvent;\n    // const mx = e.pageX*scale - size.width/2 + points[0].x*scale;\n    // const my = e.pageY*scale - size.height/2 + points[0].y*scale;\n    const mx = (e.pageX - (size.width/2 - points[0].x*scale))/scale;\n    const my = (e.pageY - (size.height/2 - points[0].y*scale))/scale;\n    const dx = mx - points[0].x;\n    const dy = my - points[0].y;\n    const distance = Math.sqrt(dx * dx + dy * dy);\n    const vx = dx / distance;\n    const vy = dy / distance;\n    setMouse({x: mx, y: my});\n    if (mx >= 0 && mx < MAX_WIDTH && my >= 0 && my < MAX_HEIGHT) {\n      setVector({x: vx, y: vy});\n    }\n  }, [mouseEvent, scale, setMouse, setVector, size, points, setMouseEvent, mouseDown]);\n\n  // const i = useRef(0);\n\n  const animate = useCallback((delta) => {\n    // const iter = i.current += 0.1 * delta;\n    const prevLength = points.length;\n    const dLength = length - prevLength;\n    const np = dLength <= 0\n      ? [...points]\n      : [...points, ...Array(length - points.length)];\n    np.length = length;\n    const last = np[prevLength - 1];\n    let vx = vector.x * speed, vy = vector.y * speed, dx = 0, dy = 0;\n\n    for (let j = 0; j < length; ++j) {\n      if (np[j] === undefined) {\n        np[j] = new PIXI.Point(last.x - vx, last.y - vy);\n        // console.error(index, [vx, vy], prevLength, length, last, np[j], RADIUS);\n      } else {\n        if (j === 0) {\n          if (np[0].x + vx - RADIUS < 0 || np[0].x + vx + RADIUS >= MAX_WIDTH) {\n            vector.x = -vector.x;\n            setVector({x: vector.x, y: vector.y});\n          }\n          if (np[0].y + vy - RADIUS < 0 || np[0].y + vy + RADIUS >= MAX_HEIGHT) {\n            vector.y = -vector.y;\n            setVector({x: vector.x, y: vector.y});\n          }\n        } else {\n          dx = np[j - 1].x - np[j].x;\n          dy = np[j - 1].y - np[j].y;\n          vx = (dx / (RADIUS * 2 + 4)) * speed;\n          vy = (dy / (RADIUS * 2 + 4)) * speed;\n        }\n        np[j].x += vx;// + Math.cos((j * .5) + iter) * 0.2;\n        np[j].y += vy;// + Math.sin((j * .5) + iter) * 0.2;\n      }\n    }\n\n    setPoints(np);\n  }, [length, points, speed, vector]);\n\n  useEffect(() => {\n    requestAnimationFrame(animate);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  useTick(delta => {\n    animate(delta);\n  });\n\n  return (\n    <Container>\n      <Container\n        scale={scale}\n        x={size.width/2 - points[0].x*scale}\n        y={size.height/2 - points[0].y*scale}\n      >\n        {/*<TilingSprite*/}\n        {/*  image={cosmosImage}*/}\n        {/*  width={MAX_WIDTH+size.width*2}*/}\n        {/*  height={MAX_HEIGHT+size.height*2}*/}\n        {/*  x={-size.width}*/}\n        {/*  y={-size.height}*/}\n        {/*  tilePosition={{x: 0, y: 0}}*/}\n        {/*  tileScale={{x: 1, y: 1}}*/}\n        {/*/>*/}\n        <TilingSprite\n          image={background}\n          width={MAX_WIDTH}\n          height={MAX_HEIGHT}\n          tilePosition={{x: 0, y: 0}}\n          tileScale={{x: 1, y: 1}}\n        />\n        <Graphics\n          draw={g => {\n            g.clear();\n            g.lineStyle(10, 0xfa0f0f);\n            // g.beginFill(0x030303, 1.0);\n            g.drawRect(0, 0, MAX_WIDTH, MAX_HEIGHT);\n            // g.endFill();\n          }}\n        />\n        {/* @ts-ignore */}\n        <Snake showPoints={showPoints}\n               points={points}\n               size={size}\n        />\n        <Graphics\n          x={0} y={0}\n          draw={g => {\n            g.clear();\n            g.beginFill(0xafffaf, 0.1);\n            g.lineStyle(2, 0xafffaf, .5);\n            g.moveTo(mouse.x, mouse.y - RADIUS * 5);\n            g.lineTo(mouse.x, mouse.y + RADIUS * 5);\n            g.moveTo(mouse.x - RADIUS * 5, mouse.y);\n            g.lineTo(mouse.x + RADIUS * 5, mouse.y);\n            g.drawCircle(mouse.x, mouse.y, RADIUS * 3);\n            // g.drawCircle(window.innerWidth / 2, window.innerHeight / 2, 150);\n            g.endFill();\n          }}\n        />\n      </Container>\n    </Container>\n  );\n});\n\n\nexport const App = () => {\n  const [size, setSize] = useState({width: window.innerWidth, height: window.innerHeight});\n  const [mouseEvent, setMouseEvent] = useState(null);\n  const [mouseDown, setMouseDown] = useState(false);\n  const [scale, setScale] = useState(1);\n\n  const resize = useCallback(() => {\n    setSize({width: window.innerWidth, height: window.innerHeight});\n  }, [setSize]);\n\n  const handleMouseDown = useCallback((e) => {\n    if (e.buttons === 1) {\n      setMouseEvent(e);\n      setMouseDown(true);\n    }\n  }, [setMouseEvent, setMouseDown]);\n\n  const handleWheel = useCallback((e: WheelEvent) => {\n    const ds = Math.sign(-e.deltaY);\n    setScale(s => {\n      let result = s + (ds > 0 ? STEP_SCALE : -STEP_SCALE);\n      result = result >= MIN_SCALE ? result : MIN_SCALE;\n      return result;\n    });\n  }, [setScale, scale])\n\n  useEffect(() => {\n    window.addEventListener('resize', resize, false);\n    window.addEventListener('wheel', handleWheel, false);\n    return () => {\n      window.removeEventListener('resize', resize, false);\n      window.removeEventListener('wheel', handleWheel, false);\n    };\n  }, [handleWheel, resize]);\n\n  return (\n    <Stage width={size.width} height={size.height}\n           options={{backgroundAlpha: 0, backgroundColor: 0, antialias: true}}\n           onPointerDown={handleMouseDown}\n           onPointerUp={() => {\n             setMouseDown(false);\n             setMouseEvent(null);\n           }}\n           onPointerMove={handleMouseDown}\n    >\n      {/* @ts-ignore */}\n      <Game mouseEvent={mouseEvent}\n            setMouseEvent={setMouseEvent}\n            mouseDown={mouseDown}\n            size={size}\n            scale={scale}\n      />\n    </Stage>\n  );\n};\n","export default \"data:image/png;base64,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ZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIgogICAgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIKICAgIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIgogICAgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIgogICAgeG1sbnM6R0lNUD0iaHR0cDovL3d3dy5naW1wLm9yZy94bXAvIgogICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iCiAgICB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iCiAgIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OUFCNjQyMkJEN0MwMTFFM0JBMjZENUQ2MEQxRUJDMTEiCiAgIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NTQyOTc2MTYtYTNiNC00YmI1LWExMDUtMDI5MDYyNzRlM2ZkIgogICB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6M2I2OTEzM2QtN2E5Mi00YzcwLWI3NjYtZTNiOWY1ZGI2Y2JhIgogICBkYzpGb3JtYXQ9ImltYWdlL3BuZyIKICAgR0lNUDpBUEk9IjIuMCIKICAgR0lNUDpQbGF0Zm9ybT0iTGludXgiCiAgIEdJTVA6VGltZVN0YW1wPSIxNjM2MzA1MjA3NjY4NTQzIgogICBHSU1QOlZlcnNpb249IjIuMTAuMjgiCiAgIHRpZmY6T3JpZW50YXRpb249IjEiCiAgIHhtcDpDcmVhdG9yVG9vbD0iR0lNUCAyLjEwIj4KICAgPHhtcE1NOkhpc3Rvcnk+CiAgICA8cmRmOlNlcT4KICAgICA8cmRmOmxpCiAgICAgIHN0RXZ0OmFjdGlvbj0ic2F2ZWQiCiAgICAgIHN0RXZ0OmNoYW5nZWQ9Ii8iCiAgICAgIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6NGUyNDAyMWItNmNiYy00ZGQ2LTg4OTYtNTIxODk4NTNhNGVlIgogICAgICBzdEV2dDpzb2Z0d2FyZUFnZW50PSJHaW1wIDIuMTAgKExpbnV4KSIKICAgICAgc3RFdnQ6d2hlbj0iMjAyMS0xMS0wN1QyMDoxMzoyNyswMzowMCIvPgogICAgPC9yZGY6U2VxPgogICA8L3htcE1NOkhpc3Rvcnk+CiAgIDx4bXBNTTpEZXJpdmVkRnJvbQogICAgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo5QUI2NDIyOUQ3QzAxMUUzQkEyNkQ1RDYwRDFFQkMxMSIKICAgIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6OUFCNjQyMjhEN0MwMTFFM0JBMjZENUQ2MEQxRUJDMTEiLz4KICA8L3JkZjpEZXNjcmlwdGlvbj4KIDwvcmRmOlJERj4KPC94OnhtcG1ldGE+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAKPD94cGFja2V0IGVuZD0idyI/PspmsQEAAAAGYktHRAD/AP8A/6C9p5MAAAAJcEhZcwAACxMAAAsTAQCanBgAAAAHdElNRQflCwcRDRtCdVffAAAD5klEQVRo3u2bz2pbRxTGvzOSFjGFUMiyZNvGi/YBuuwTtO+QZSGbUMgmEGJDVl101VVpoQ+QB3BeoN4khNgJJDQOJk2E/8iyZOvOzPd1obnK6FqW2jS1HZgfHGbmzNW9F4F+nJmra1pZWYJ0FcAPAL6F5AAIZoJkAFqQOgDaaWwoFApnjQcgABEAU1tHyMJnUWUxyuI4xVFqh6k/BDCYhHQIYBzSAaS+3bkzOM8voQ1gCcA3AL6GtJTyhGSQ2pAcpHG2bguFwlnTOfc7MINu3w4w6wHoAdhPsQdgN8UOpB0AXQBdkG8hvbG7dz+I6EwrK19C+g3AclZRTeYhYSpqirwKhYuB2bvfY94/bf6/Xqt5jub18jFZ53pw7jVarW0A25BeAdiC9BLkC3j/3O7d4+IKy+wrAJ8B6EAaX6COWlJ5v4iqUPi4ZPa+x+T5uv8+wjMDnLsMs8uQvphasdVhFnXr1jN0OhuQHkN6iBjXbXV1a1pY3leQ/JSomoJq5kuVVShcPPH8WwnNyzdlNW9+3jnyaJL7w7kWnLsG8hqk70ACMUI3bz5Bq7UG5+7b6upaG1X1CSR3QliNCsuTiBKiBElQEVahcO6yskU5s6nxVD+d17Lx5Kla1nenVVfzKrBFspquvt4tW5srOeeWIS3D++9148bPbXjfQwhOSVAkQRJKcooSmCTFXFaFQuHj8t4cGc6Tms06T5a3Gcc6s2kBnnLtdlNomV8szYnEUQjoVRXag+Hw88r7KzHJypofWnDzhULh4qMUJ5ZkjQJEkylNj7MVlbJx3a8LGUlgYyxgXOzUbVYIMeUiOW4lBAmehI8RnnxyHOPaoff3rz94sNbu9vuVSHH8hBAt56Zu1JnB1bJaZMxCoXAm8lmY/6ciyqRTf2YinIZsTogpm68j5pG2kZgLKgkppG0mHyOOx2KKgXwWpY1APh6E8LBfVes/PXo0veneH43+ILlnZp/KzJhu3GZVV1ZUVShcCFnN2JpRJqRFUlIjv0hEnFEtqVktpeNCElU1FhHCWF49Sq8pbQdpO5KvPLlVkS8H3r84qKrnv25uLv5bw5VLl9b/PDj48TCE66MYrzLJyqVNMObrySmBa67tC4XCGVRYzWVaQ1Kzfq+zRNWUVD03o1oKAnqSegT2Ke1T2qO0C2A3kjtB2glk15PdoxDeDkN488vGxgf542i745xrO7f513B43D064nGMJhIt54ySPDnZQHNmkGQ6xfCFQuH/wQCfnp1FADQgCoiQIoCgFJZey9E4KkiV0qs5AkaSRspezaF0LGBI6YjSkNJA0oDSIEqHdQTyoCL7vz99eq6v5vwNdwaoUEKX1x0AAAAASUVORK5CYII=\"","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport {App} from './App';\n// import {app} from './pixi/base/application';\n// import {AppProvider} from '@inlet/react-pixi';\nimport Peer, {DataConnection} from 'peerjs';\n// import Peer from 'simple-peer';\n\nconst isProd = process.env.NODE_ENV === 'production';\n// @ts-ignore\nconst url = new URL(window.location);\nconst port = Number(url.searchParams.get('port') || 9000);\n\nconst peer = new Peer({\n  host: isProd ? 'https://zmey.herokuapp.com/' : 'localhost',\n  port: isProd ? port : 9000,\n  config: {\n    iceServers: [\n      // {urls: 'stun:stun01.sipphone.com'},\n      // {urls: 'stun:stun.ekiga.net'},\n      // {urls: 'stun:stun.fwdnet.net'},\n      // {urls: 'stun:stun.ideasip.com'},\n      // {urls: 'stun:stun.iptel.org'},\n      // {urls: 'stun:stun.rixtelecom.se'},\n      // {urls: 'stun:stun.schlund.de'},\n      // {urls: 'stun:stun.l.google.com:19302'},\n      // {urls: 'stun:stun1.l.google.com:19302'},\n      // {urls: 'stun:stun2.l.google.com:19302'},\n      // {urls: 'stun:stun3.l.google.com:19302'},\n      // {urls: 'stun:stun4.l.google.com:19302'},\n      // {urls: 'stun:stunserver.org'},\n      // {urls: 'stun:stun.softjoys.com'},\n      // {urls: 'stun:stun.voiparound.com'},\n      // {urls: 'stun:stun.voipbuster.com'},\n      // {urls: 'stun:stun.voipstunt.com'},\n      // {urls: 'stun:stun.voxgratia.org'},\n      // {urls: 'stun:stun.xten.com'},\n      {\n        urls: 'turn:numb.viagenie.ca',\n        credential: 'muazkh',\n        username: 'webrtc@live.com',\n      },\n      {\n        urls: 'turn:192.158.29.39:3478?transport=udp',\n        credential: 'JZEOEt2V3Qb0y27GRntt2u2PAYA=',\n        username: '28224511:1379330808',\n      },\n      {\n        urls: 'turn:192.158.29.39:3478?transport=tcp',\n        credential: 'JZEOEt2V3Qb0y27GRntt2u2PAYA=',\n        username: '28224511:1379330808',\n      },\n    ],\n  },\n  secure: false //isProd,\n});\n\n// @ts-ignore\nwindow.peer = peer;\n// @ts-ignore\nwindow.Peer = Peer;\n\nlet peers: { conn: { [key: string]: DataConnection } } = {\n  conn: {},\n};\n// @ts-ignore\nwindow.peers = peers;\n\nconst bindConnection = (conn: DataConnection) => {\n  const id = conn.peer;\n  conn.on('open', () => {\n    console.log('%c- conn.on.open', 'color:blue', conn.open, id);\n    peers.conn[id].send(`Hello from ${peer.id}`);\n  });\n  conn.on('data', (e) => {\n    console.log('%c- conn.on.data', 'color:blue', e);\n  });\n  conn.on('close', () => {\n    console.log('%c- conn.on.close', 'color:red');\n  });\n  conn.on('error', (err) => {\n    console.error('- conn.on.error', err);\n  });\n}\n\npeer.on('connection', (conn) => {\n  const destId = conn.peer;\n  console.log(`%cpeer.on.connection from ${destId}`, 'color:darkgreen');\n  bindConnection(conn);\n  peers.conn[destId] = conn;\n});\n\npeer.on('open', id => {\n  console.log('%cpeer.on.open', 'color:green', id);\n  // peer.listAllPeers(ids => {\n  //   for (id of ids) {\n  //     if (id === peer.id) continue;\n  //     // peer.connect(id);\n  //   }\n  // });\n});\n\npeer.on('call', (mc) => {\n  console.log('%cpeer.on.call', 'color:orange', mc);\n});\n\npeer.on('close', () => {\n  peers.conn = {};\n  console.log('%cpeer.on.close', 'color:red');\n});\n\npeer.on('disconnected', () => {\n  peers.conn = {};\n  console.log('%cpeer.on.disconnected', 'color:red');\n});\n\npeer.on('error', err => console.error(err));\n\n// @ts-ignore\npeer.socket.on('message', (message) => {\n  switch (message.type) {\n    case 'SNAKE/ADD_PEER': {\n      console.log(message);\n      const id = message.payload;\n      console.log('%cpeer.connect', 'color:#03c700', id);\n      peers.conn[id] = peer.connect(id);\n      bindConnection(peers.conn[id]);\n      break;\n    }\n    case 'SNAKE/REMOVE_PEER': {\n      console.log(message);\n      const id = message.payload;\n      // @ts-ignore\n      delete peers.conn[id];\n      break;\n    }\n  }\n});\n\n\nReactDOM.render(\n  <App />,\n  document.getElementById('root'),\n);\n"],"sourceRoot":""}